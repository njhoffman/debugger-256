{"version":3,"sources":["../lib/parser.js"],"names":["require","maxBy","isObject","isUndefined","getOptions","getSubsystems","indent","num","Array","join","parseMessage","messages","subsystem","render","ssLength","length","ss","out","message","i","nextMsg","test","match","forEach","renderObj","colorTag","customColors","console","warn","customMessage","replace","module","exports"],"mappings":";;eAAyCA,QAAQ,QAAR,C;IAAjCC,K,YAAAA,K;IAAOC,Q,YAAAA,Q;IAAUC,W,YAAAA,W;;gBACaH,QAAQ,YAAR,C;IAA9BI,U,aAAAA,U;IAAYC,a,aAAAA,a;;AAEpB,IAAMC,SAAS,SAATA,MAAS,CAACC,GAAD,EAAS;AACtB,SAAOC,MAAOD,MAAM,CAAN,GAAUA,GAAV,GAAiB,CAAxB,EAA4BE,IAA5B,CAAiC,GAAjC,CAAP;AACD,CAFD;;AAIA,IAAMC,eAAe,SAAfA,YAAe,CAACC,QAAD,EAAWC,SAAX,EAAsBC,MAAtB,EAAiC;AACpD,MAAMC,WAAWT,gBAAgBU,MAAhB,GAAyB,CAAzB,GACfd,MAAMI,eAAN,EAAuB,UAACW,EAAD;AAAA,WAAQA,GAAGD,MAAX;AAAA,GAAvB,EAA0CA,MAA1C,GAAmD,CADpC,GACwCH,UAAUG,MADnE;AAEA,MAAIE,MAAM,EAAV;;AAHoD;AAKlD,QAAIC,UAAUP,SAASQ,EAAT,CAAd;AACA,QAAIjB,SAASgB,OAAT,CAAJ,EAAuB;AACrBD,aAAO,OAAOJ,OAAOK,OAAP,EAAgBJ,WAAW,CAA3B,CAAd;AACD,KAFD,MAEO;AACL,UAAIM,UAAUT,SAASQ,KAAI,CAAb,CAAd;AACA,UAAI,OAAOE,IAAP,CAAYH,OAAZ,KAAwBE,QAAQ,OAAR,CAA5B,EAA8C;AAC5CD;AACA;AACAD,gBAAQI,KAAR,CAAc,UAAd,EAA0BC,OAA1B,CAAkC,yBAAiB;AACjD,cAAIC,YAAY,EAAhB;AACA,cAAIC,WAAWL,WAAWA,QAAQ,OAAR,CAA1B;AACA,cAAIK,YAAYtB,YAAYC,aAAasB,YAAb,CAA0BD,QAA1B,CAAZ,CAAhB,EAAkE;AAChEE,oBAAQC,IAAR,+CAAyDH,QAAzD;AACD,WAFD,MAEO,IAAIA,QAAJ,EAAc;AACnBD,sBAAUC,QAAV,IAAsBI,cAAcC,OAAd,CAAsB,IAAtB,EAA4B,EAA5B,CAAtB;AACAZ,sBAAUA,QAAQY,OAAR,CAAgBD,aAAhB,EAA+BhB,OAAOW,SAAP,CAA/B,CAAV;AACD;AACDJ,oBAAUT,SAASQ,KAAI,CAAb,CAAV;AACAA;AACD,SAXD;AAYAF,eAAOX,OAAOQ,WAAWF,UAAUG,MAA5B,IAAsC,KAAtC,GAA8CG,OAArD;AACD,OAhBD,MAgBO,IAAIC,OAAM,CAAV,EAAa;AAClBF,eAAOX,OAAOQ,WAAWF,UAAUG,MAA5B,IAAsC,KAAtC,GAA8CF,OAAOK,OAAP,CAArD;AACD,OAFM,MAEA;AACLD,eAAO,OAAOT,MAAMM,WAAW,CAAjB,EAAoBL,IAApB,CAAyB,GAAzB,CAAP,GAAuCI,OAAOK,OAAP,CAA9C;AACD;AACF;AA3BMC,KAJ2C;AAAA;;AAIpD,OAAK,IAAIA,IAAI,CAAb,EAAgBA,IAAIR,SAASI,MAA7B,EAAqCI,GAArC,EAA0C;AAAA,UAAjCA,CAAiC;AA4BzC;AACD,SAAOF,GAAP;AACD,CAlCD;;AAoCAc,OAAOC,OAAP,GAAiBtB,YAAjB","file":"parser.js","sourcesContent":["const { maxBy, isObject, isUndefined } = require('lodash');\nconst { getOptions, getSubsystems } = require('./settings');\n\nconst indent = (num) => {\n  return Array((num > 0 ? num  : 1)).join(' ');\n};\n\nconst parseMessage = (messages, subsystem, render) => {\n  const ssLength = getSubsystems().length > 0 ?\n    maxBy(getSubsystems(), (ss) => ss.length).length + 1 : subsystem.length;\n  let out = '';\n  for (let i = 0; i < messages.length; i++) {\n    let message = messages[i];\n    if (isObject(message)) {\n      out += '\\n' + render(message, ssLength + 7);\n    } else {\n      let nextMsg = messages[i + 1];\n      if (/%.*%/.test(message) && nextMsg['color']) {\n        i++;\n        // check for special color directive\n        message.match(/(%.*?%)/g).forEach(customMessage => {\n          let renderObj = {};\n          let colorTag = nextMsg && nextMsg['color'];\n          if (colorTag && isUndefined(getOptions().customColors[colorTag])) {\n            console.warn(`\\n -- Debugger Warning: Color Directive \"${colorTag}\" was not found in the settings. --\\n`);\n          } else if (colorTag) {\n            renderObj[colorTag] = customMessage.replace(/%/g, '');\n            message = message.replace(customMessage, render(renderObj));\n          }\n          nextMsg = messages[i + 1];\n          i++;\n        });\n        out += indent(ssLength - subsystem.length) + '   ' + message;\n      } else if (i === 0) {\n        out += indent(ssLength - subsystem.length) + '   ' + render(message);\n      } else {\n        out += '\\n' + Array(ssLength + 7).join(' ') + render(message);\n      }\n    }\n  }\n  return out;\n};\n\nmodule.exports = parseMessage;\n"]}